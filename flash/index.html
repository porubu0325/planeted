<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flash Hub</title>

    <!-- CSS読み込み -->
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/main_m.css">
    <link rel="stylesheet" href="../css/header.css">
    <link rel="stylesheet" href="../css/header_m.css">
    <link rel="stylesheet" href="../css/footer.css">
    <link rel="stylesheet" href="../css/footer_m.css">
    <link rel="stylesheet" href="./flash.css">

    <!-- JavaScript読み込み -->
    <script src="../js/common.js"></script>
    <script src="./ruffle/ruffle.js"></script>
</head>
<body>
    <!-- ヘッダー -->
    <!-- メインコンテンツ -->

    <!-- 一覧
    小小系列 - Xiao Xiao 1(01.swf) - Xiao Xiao 2 (02.swf) - Xiao Xiao 3 (03.swf)
    Eden - あるエアコンの修繕(e1.swf) - あるコンビニの宣伝(02.swf) - ある夕食の風景(03.swf)
    ドラサイト - ドラ1 (dora.swf) - ドラえもん(dooraemon.swf) - what - とびだしゃ(tobidasi.swf) - 再起動(saikido.swf) - ラディえもん(radhiemon.swf) - orasaito.swf - ora1.swf - aaaah.swf - スピルバソ (spil.
    ビデオ - 赤い部屋(red_room1.swf) - Nightmare City(nightmare.swf) - 122307.swf
    その他 - 7.swf - 
    -->
    <main>
        <h2>Flash倉庫</h2>
        <p>いろんな懐かしいFlashを集めてみました。Flash Playerは2021年1月にサポート終了していますが、<a href="http://ruffle.rs" target="_blank">Ruffle</a>というオープンソースのエミュレータを利用することによりFlash Playerがなくても動作できるようになっています。
        <!-- Ruffleの読み込み -->
        <section>
        <nav id="menu">
            <article>
                <h3>動画</h3>
                <button data-swf="./rasaito/dora.swf">ドラ１ まるかいててー（仮）</button>
                <button data-swf="./xiao/01.swf">小小作品01</button>
                <button data-swf="./xiao/02.swf">小小作品02</button>
                <button data-swf="./xiao/03.swf">小小作品03</button>
                <button data-swf="072514.swf">ウォーリーをさがさないで</button>
                <button data-swf="002.swf">名古屋はええよ！やっとかめ</button>
                <button data-swf="nightmare.swf">Nightmare City</button>
                <button data-swf="maiahi.swf">恋のマイアヒ</button>
                <button data-swf="youareanidiot.swf">You are an idiot!</button>
                <button data-swf="2chkiki.swf">2ちゃんねる 8月危機</button>
                <button data-swf="moudamepo.swf">もうだめぽ</button>
                <button data-swf="natsumi.swf">なつみSTEP!</button>
                <button data-swf="natsumi-omake.swf">なつみSTEP! - おまけ</button>
                <button data-swf="nezumi.swf">ネズミーマウスマーチ</button>
            </article>
            <article>
               <h3>ゲーム</h3>
                <button data-swf="homerun.swf">くまのプーさんのホームランダービー！</button>
                <button data-swf="win31esc.swf">Windows 3.1からの脱出</button>
                <button data-swf="korotuke.swf">おいしいコロッケをつくろう！</button>
                <button data-swf="dare.swf">誰か開けてモナー</button>
                <button data-swf="red_room1.swf">赤い部屋</button>
            </article>
        </nav>
        </section>
        <section id="player">
            <div id="flash-container">
                <div class="no-content">上のメニューからFlashを選択してください</div>
            </div>
        </section>
        <section>
            <h3>注意</h3>
            <p>※スマートフォンでも動かせますが、ゲーム系は操作できない可能性があるため、基本PC推奨です。<br>
        ※このウェブサイトは、インターネット遺産の保護を目的としてswfファイルの保管および運営を行っていますが、なにか問題があればこちらからご連絡ください。直ちに対応、及び削除いたします。</p></p>
        </section>
    </main>
    
    <script>
        // URLパラメータの取得
        function getURLParameter(name) {
            const params = new URLSearchParams(window.location.search);
            return params.get(name);
        }

        // URLパラメータの設定
        function setURLParameter(name, value) {
            const url = new URL(window.location);
            url.searchParams.set(name, value);
            window.history.pushState({}, '', url);
        }

        // Flashの読み込み
        function loadFlash(swfFile) {
            if (!swfFile) return;

            const container = document.getElementById('flash-container');
            container.innerHTML = '';

            const playerWrapper = document.createElement('div');
            playerWrapper.id = 'player-wrapper';
            container.appendChild(playerWrapper);

            const ruffle = window.RufflePlayer.newest();
            const player = ruffle.createPlayer();
            playerWrapper.appendChild(player);

            player.style.width = '100%';
            player.style.height = '100%';

            const swfUrl = `./swf/${swfFile}`;
            player.load(swfUrl);

            // アクティブなボタンの更新
            document.querySelectorAll('nav button').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.swf === swfFile) {
                    btn.classList.add('active');
                }
            });

            // URLパラメータの更新
            setURLParameter('swf', swfFile);
        }

        // メニューボタンのイベントリスナー
        document.getElementById('menu').addEventListener('click', (e) => {
            if (e.target.tagName === 'BUTTON') {
                const swfFile = e.target.dataset.swf;
                loadFlash(swfFile);
            }
        });

        // ページ読み込み時の処理
        window.addEventListener('DOMContentLoaded', () => {
            const swfParam = getURLParameter('swf');
            if (swfParam) {
                loadFlash(swfParam);
            }
        });

        // ブラウザの戻る/進むボタン対応
        window.addEventListener('popstate', () => {
            const swfParam = getURLParameter('swf');
            if (swfParam) {
                loadFlash(swfParam);
            } else {
                document.getElementById('flash-container').innerHTML = 
                    '<div class="no-content">上のメニューからFlashを選択してください</div>';
                document.querySelectorAll('nav button').forEach(btn => {
                    btn.classList.remove('active');
                });
            }
        });
    </script>


    <footer class="footer_class"><div id="footer"></div></footer>
</body>
</html>